{"version":3,"sources":["script.js"],"names":["count","destination","action","replace","document","querySelector","innerText","utiliseForm","nodes","error","createElement","amend","waiting","success","failed","contactme","className","appendChild","createTextNode","contactLink","setAttribute","onsubmit","event","preventDefault","parentNode","removeChild","replaceChild","form","data","reduce","call","accumulator","name","value","Object","assign","trim","subject","contact","insertBefore","date","Date","toUTCString","fetch","headers","method","mode","cache","credentials","redirect","referrer","body","JSON","stringify","then","response","ok","Error","catch","err","setTimeout","forEach","querySelectorAll","replaceAnchorBehaviour","anchor","addEventListener","getAttribute","scrollIntoView","behavior","loadMap","frame","prop","readyState","window","once","scrollY","innerHeight"],"mappings":"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","file":"script.893cac94.js","sourceRoot":"../src","sourcesContent":["let count = 0;\nfunction destination (action) {\n\treturn action.replace(/\\?to=.*/, '?to=' + document.querySelector('a[href^=\"mailto:\"]').innerText)\n}\n\nif (document.readyState === 'complete') {\n\tutiliseForm();\n} else {\n\twindow.addEventListener('DOMContentLoaded', utiliseForm, { once: true });\n}\n\nif (window.scrollY > window.innerHeight) {\n\tloadMap();\n} else {\n\twindow.addEventListener('scroll', loadMap, { once: true });\n}\n\nfunction utiliseForm() {\n\tvar nodes = {\n\t\terror: document.createElement('p'),\n\t\tamend: document.createElement('p'),\n\t\twaiting: document.createElement('p'),\n\t\tsuccess: document.createElement('h3'),\n\t\tfailed: document.createElement('h3'),\n\t\tcontactme: contactme\n\t};\n\tnodes.error.className = 'error';\n\tnodes.error.appendChild(document.createTextNode('Something went wrong, please try again.'));\n\tnodes.amend.className = 'error';\n\tnodes.amend.appendChild(document.createTextNode('Please fill out name and contact method.'));\n\tnodes.waiting.appendChild(document.createTextNode('Thank you'));\n\tnodes.success.appendChild(document.createTextNode('I will return to you shortly'));\n\tnodes.failed.appendChild(document.createTextNode('Sorry, the form was not sent.'));\n\tvar contactLink = document.createElement('a');\n\tcontactLink.setAttribute('href', '#address')\n\tcontactLink.appendChild(document.createTextNode('Please try a different contact method.'));\n\tnodes.failed.appendChild(document.createElement('br'))\n\tnodes.failed.appendChild(contactLink);\n\n\tnodes.contactme.onsubmit = function(event) {\n\t\tevent.preventDefault();\n\n\t\tnodes.error.parentNode && nodes.error.parentNode.removeChild(nodes.error);\n\t\tnodes.amend.parentNode && nodes.amend.parentNode.removeChild(nodes.amend);\n\t\tnodes.contactme.parentNode.replaceChild(nodes.waiting, nodes.contactme);\n\n\t\tvar data = serialise(nodes.contactme);\n\t\tdata.subject = 'Message from danisilas.com'\n\n\t\tif (!data.name || !data.contact) {\n\t\t\tnodes.waiting.parentNode.replaceChild(nodes.contactme, nodes.waiting);\n\t\t\tnodes.contactme.parentNode.insertBefore(nodes.amend, nodes.contactme);\n\t\t\treturn;\n\t\t}\n\n\t\tdata.date = new Date().toUTCString();\n\n\t\tfetch(\n\t\t\t\tdestination(nodes.contactme.action),\n\t\t\t\t{\n\t\t\t\t\theaders: {'Content-Type': 'application/json; charset=utf-8'},\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tmode: 'cors',\n\t\t\t\t\tcache: 'no-cache',\n\t\t\t\t\tcredentials: 'same-origin',\n\t\t\t\t\tredirect: 'follow',\n\t\t\t\t\treferrer: 'no-referrer',\n\t\t\t\t\tbody: JSON.stringify(data)\n\t\t\t\t}\n\t\t).then(function (response) {\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error('Request failed');\n\t\t\t}\n\t\t\tnodes.waiting.parentNode.replaceChild(nodes.success, nodes.waiting);\n\t\t}).catch(function (err) {\n\t\t\tif (count > 3) {\n\t\t\t\tnodes.waiting.parentNode.replaceChild(nodes.failed, nodes.waiting);\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst error = new Error('Failed to send contact form');\n\t\t\tsetTimeout(function() { throw error; });\n\n\t\t\tnodes.waiting.parentNode.replaceChild(nodes.contactme, nodes.waiting);\n\t\t\tnodes.contactme.parentNode.insertBefore(nodes.error, nodes.contactme);\n\t\t\tcount++\n\t\t});\n\t}\n\n\tfunction serialise(form) {\n\t\treturn [].reduce.call(\n\t\t\t\tform,\n\t\t\t\t(accumulator, {name, value}) => value ? Object.assign(\n\t\t\t\t\taccumulator,\n\t\t\t\t\t{ [name]: value.trim() }\n\t\t\t\t) : accumulator,\n\t\t\t\t{}\n\t\t\t);\n\t}\n\n\t[].forEach.call(\n\t\tdocument.querySelectorAll('a[href^=\"#\"]'),\n\t\treplaceAnchorBehaviour\n\t);\n\n\treplaceAnchorBehaviour(contactLink);\n}\n\nfunction replaceAnchorBehaviour(anchor) {\n\tanchor.addEventListener('click', function(event) {\n\t\tevent.preventDefault();\n\n\t\tvar destination = document.querySelector('[name=\"' + anchor.getAttribute('href').replace('#', '') + '\"]');\n\n\t\tdestination.scrollIntoView({behavior: 'smooth'});\n\t});\n}\n\nfunction loadMap() {\n\tconst frame = document.createElement('iframe');\n\t[\n\t\t[ 'title', 'My Office Location' ],\n\t\t[ 'width', '100%' ],\n\t\t[ 'height', '100%' ],\n\t\t[ 'src', 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2478.7957283073088!2d-0.1435368157730345!3d51.590307079648746!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x48761b3e977d91b5%3A0xf02ada7628d85293!2sDan%20I%20Silas%20Chartered%20Surveyor!5e0!3m2!1siw!2sil!4v1594805579242!5m2!1siw!2sil' ],\n\t\t[ 'frameborder', '0'] ,\n\t\t[ 'scrolling', 'no'] ,\n\t\t[ 'marginheight', '0'] ,\n\t\t[ 'marginwidth', '0']\n\t].forEach(\n\t\t([ prop, value ]) => frame.setAttribute(prop, value)\n\t);\n\tdocument.querySelector('footer').appendChild(frame);\n}\n"]}