{"version":3,"sources":["script.js"],"names":["count","destination","action","replace","document","querySelector","innerText","utiliseForm","nodes","error","createElement","amend","waiting","success","failed","contactme","className","appendChild","createTextNode","contactLink","setAttribute","onsubmit","event","preventDefault","parentNode","removeChild","replaceChild","form","data","reduce","call","accumulator","_ref","name","value","Object","assign","_defineProperty","trim","subject","contact","insertBefore","date","Date","toUTCString","fetch","headers","method","mode","cache","credentials","redirect","referrer","body","JSON","stringify","then","response","ok","Error","catch","err","setTimeout","forEach","querySelectorAll","replaceAnchorBehaviour","anchor","addEventListener","getAttribute","scrollIntoView","behavior","loadMap","frame","_ref2","_ref3","_slicedToArray","prop","readyState","window","once","scrollY","innerHeight"],"mappings":"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","file":"script.6c2dd737.js","sourceRoot":"../src","sourcesContent":["let count = 0;\nfunction destination (action) {\n\treturn action.replace(/\\?to=.*/, '?to=' + document.querySelector('a[href^=\"mailto:\"]').innerText)\n}\n\nif (document.readyState === 'complete') {\n\tutiliseForm();\n} else {\n\twindow.addEventListener('DOMContentLoaded', utiliseForm, { once: true });\n}\n\nif (window.scrollY > window.innerHeight) {\n\tloadMap();\n} else {\n\twindow.addEventListener('scroll', loadMap, { once: true });\n}\n\nfunction utiliseForm() {\n\tvar nodes = {\n\t\terror: document.createElement('p'),\n\t\tamend: document.createElement('p'),\n\t\twaiting: document.createElement('p'),\n\t\tsuccess: document.createElement('h3'),\n\t\tfailed: document.createElement('h3'),\n\t\tcontactme: contactme\n\t};\n\tnodes.error.className = 'error';\n\tnodes.error.appendChild(document.createTextNode('Something went wrong, please try again.'));\n\tnodes.amend.className = 'error';\n\tnodes.amend.appendChild(document.createTextNode('Please fill out name and contact method.'));\n\tnodes.waiting.appendChild(document.createTextNode('Thank you'));\n\tnodes.success.appendChild(document.createTextNode('I will return to you shortly'));\n\tnodes.failed.appendChild(document.createTextNode('Sorry, the form was not sent.'));\n\tvar contactLink = document.createElement('a');\n\tcontactLink.setAttribute('href', '#address')\n\tcontactLink.appendChild(document.createTextNode('Please try a different contact method.'));\n\tnodes.failed.appendChild(document.createElement('br'))\n\tnodes.failed.appendChild(contactLink);\n\n\tnodes.contactme.onsubmit = function(event) {\n\t\tevent.preventDefault();\n\n\t\tnodes.error.parentNode && nodes.error.parentNode.removeChild(nodes.error);\n\t\tnodes.amend.parentNode && nodes.amend.parentNode.removeChild(nodes.amend);\n\t\tnodes.contactme.parentNode.replaceChild(nodes.waiting, nodes.contactme);\n\n\t\tvar data = serialise(nodes.contactme);\n\t\tdata.subject = 'Message from danisilas.com'\n\n\t\tif (!data.name || !data.contact) {\n\t\t\tnodes.waiting.parentNode.replaceChild(nodes.contactme, nodes.waiting);\n\t\t\tnodes.contactme.parentNode.insertBefore(nodes.amend, nodes.contactme);\n\t\t\treturn;\n\t\t}\n\n\t\tdata.date = new Date().toUTCString();\n\n\t\tfetch(\n\t\t\t\tdestination(nodes.contactme.action),\n\t\t\t\t{\n\t\t\t\t\theaders: {'Content-Type': 'application/json; charset=utf-8'},\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tmode: 'cors',\n\t\t\t\t\tcache: 'no-cache',\n\t\t\t\t\tcredentials: 'same-origin',\n\t\t\t\t\tredirect: 'follow',\n\t\t\t\t\treferrer: 'no-referrer',\n\t\t\t\t\tbody: JSON.stringify(data)\n\t\t\t\t}\n\t\t).then(function (response) {\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error('Request failed');\n\t\t\t}\n\t\t\tnodes.waiting.parentNode.replaceChild(nodes.success, nodes.waiting);\n\t\t}).catch(function (err) {\n\t\t\tif (count > 3) {\n\t\t\t\tnodes.waiting.parentNode.replaceChild(nodes.failed, nodes.waiting);\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst error = new Error('Failed to send contact form');\n\t\t\tsetTimeout(function() { throw error; });\n\n\t\t\tnodes.waiting.parentNode.replaceChild(nodes.contactme, nodes.waiting);\n\t\t\tnodes.contactme.parentNode.insertBefore(nodes.error, nodes.contactme);\n\t\t\tcount++\n\t\t});\n\t}\n\n\tfunction serialise(form) {\n\t\treturn [].reduce.call(\n\t\t\t\tform,\n\t\t\t\t(accumulator, {name, value}) => value ? Object.assign(\n\t\t\t\t\taccumulator,\n\t\t\t\t\t{ [name]: value.trim() }\n\t\t\t\t) : accumulator,\n\t\t\t\t{}\n\t\t\t);\n\t}\n\n\t[].forEach.call(\n\t\tdocument.querySelectorAll('a[href^=\"#\"]'),\n\t\treplaceAnchorBehaviour\n\t);\n\n\treplaceAnchorBehaviour(contactLink);\n}\n\nfunction replaceAnchorBehaviour(anchor) {\n\tanchor.addEventListener('click', function(event) {\n\t\tevent.preventDefault();\n\n\t\tvar destination = document.querySelector('[name=\"' + anchor.getAttribute('href').replace('#', '') + '\"]');\n\n\t\tdestination.scrollIntoView({behavior: 'smooth'});\n\t});\n}\n\nfunction loadMap() {\n\tconst frame = document.createElement('iframe');\n\t[\n\t\t[ 'title', 'My Office Location' ],\n\t\t[ 'width', '100%' ],\n\t\t[ 'height', '100%' ],\n\t\t[ 'src', 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2478.9407597377513!2d-0.2043677!3d51.5876491!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x487610ba6dd61d37%3A0x409013cca5892a83!2s62%20Hurstwood%20Rd%2C%20London%20NW11%200AU!5e0!3m2!1sen!2suk!4v1692690955363!5m2!1sen!2suk' ],\n\t\t[ 'frameborder', '0'] ,\n\t\t[ 'scrolling', 'no'] ,\n\t\t[ 'marginheight', '0'] ,\n\t\t[ 'marginwidth', '0']\n\t].forEach(\n\t\t([ prop, value ]) => frame.setAttribute(prop, value)\n\t);\n\tdocument.querySelector('footer').appendChild(frame);\n}\n"]}